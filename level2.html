<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <title>CodeBusters C++ – Ниво 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
  <link rel="stylesheet" href="stylelevels.css"/>
  <link rel="stylesheet" href="stylelevel2.css">
</head>
<body>

<header>
  <h1>CodeBusters C++ – Ниво 2: Въвеждане на вход</h1>
</header>

<main>
  <div id="container">
    <div id="instructions">
      <h2>Мисия</h2>
      <p>Добавете два реда C++ код между <code>main()</code> и <code>return 0;</code>:</p>
      <ol>
        <p><code>1. cin >> name;</code> за въвеждане на вход от потребителя.</p>
        <p><code>2. cout << "Hello, " << name << "!";</code> за поздрав.</p>
      </ol>
      <p><code>#include &lt;iostream&gt;</code>, <code>using namespace std;</code> и <code>string name;</code> са вече добавени.</p>
    </div>

    
    <div id="playground">
      <div id="codeWrapper">
        <pre class="codeLine">#include &lt;iostream&gt;</pre>
        <pre class="codeLine">using namespace std;</pre>
        <pre class="codeLine">int main() {</pre>
        <pre class="codeLine">    string name;</pre>
        <input type="text" id="codeInput1" placeholder="    cin >> name;" autocomplete="off" spellcheck="false" />
        <input type="text" id="codeInput2" placeholder="    cout << &quot;Hello, &quot; << name << &quot;!&quot;;" autocomplete="off" spellcheck="false" />
        <pre class="codeLine">    return 0;</pre>
        <pre class="codeLine">}</pre>
      </div>

      <button id="runBtn">Стартирай кода</button>

     
      <div id="nameInputWrapper" style="display:none; margin-top: 1rem;">
        <input type="text" id="userInput" placeholder="Въведете име..." autocomplete="off" spellcheck="false" style="padding:0.5rem;border-radius:6px;width:100%;" />
        <button id="sayHelloBtn" style="margin-top:0.5rem;">Изведи поздрав</button>
      </div>

      <div id="outputWindow"></div>

      <div id="levelButtons">
        <button id="nextLevelBtn" style="display: none;">Следващо ниво</button>
        <a href="main.html"><button id="menuBtn">Меню</button></a>
      </div>
    </div>
  </div>
</main>

<footer>
  &copy; Направено от Камен и Георги – най‑добрите програмисти
</footer>

<script>
(() => {
  const input1 = document.getElementById('codeInput1');
  const input2 = document.getElementById('codeInput2');
  const runBtn = document.getElementById('runBtn');
  const output = document.getElementById('outputWindow');
  const nextBtn = document.getElementById('nextLevelBtn');
  const nameWrapper = document.getElementById('nameInputWrapper');
  const userInput = document.getElementById('userInput');
  const sayHelloBtn = document.getElementById('sayHelloBtn');

  input1.addEventListener('keydown', e => {
    if (e.key === 'Enter') { e.preventDefault(); input2.focus(); }
  });
  input2.addEventListener('keydown', e => {
    if (e.key === 'Enter') { e.preventDefault(); runBtn.click(); }
  });

  function check(cinLine, coutLine) {
    const cinOk = /^\s*cin\s*>>\s*name\s*;\s*$/.test(cinLine);
    const coutOk = /^\s*cout\s*<<\s*"Hello,\s*"\s*<<\s*name\s*<<\s*"!"\s*;\s*$/.test(coutLine);
    if (cinOk && coutOk) return { ok: true };
    if (!cinOk) return { ok: false, msg: 'cin редът трябва да бъде: cin >> name;' };
    if (!coutOk) return { ok: false, msg: 'cout редът трябва да изведе Hello, name! точно.' };
    return { ok: false, msg: 'Проверете синтаксиса и форматирането.' };
  }

  runBtn.addEventListener('click', () => {
    const res = check(input1.value.trim(), input2.value.trim());
    output.innerHTML = '';
    nextBtn.style.display = 'none';
    nameWrapper.style.display = 'none';

    if (res.ok) {
      output.innerHTML = '<span class="success">✅ Кодът е правилен!</span>\n\nМоля, въведете име по-долу:';
      nameWrapper.style.display = 'block';
    } else {
      output.innerHTML = `<span class="error">⛔ ${res.msg}</span>`;
    }
  });

  sayHelloBtn.addEventListener('click', () => {
    const name = userInput.value.trim();
    if (!name) {
      output.innerHTML += `\n<span class="error">⛔ Моля, въведете име.</span>`;
      return;
    }

    output.innerHTML += `\n\n<span class="success">Hello, ${name}!</span>\n✅ Нивото е преминато!`;
    nextBtn.style.display = 'inline-block';
  });

  nextBtn.addEventListener('click', () => {
    window.location.href = 'level3.html';
  });
})();
</script>

</body>
</html>
